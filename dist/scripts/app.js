function initMap(){function e(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1400)}function o(e){return void 0!==e.photos&&e.photos.length>0?'<img src="'+e.photos[0].getUrl({maxWidth:120})+'"/><br/>'+e.name+"<br/>"+e.formatted_address+"<br/>":e.name+"<br/>"+e.formatted_address+"<br/>"}function t(t,n){var a=this;a.data=t,a.marker=new google.maps.Marker({map:n,position:t.geometry.location}),a.showDetail=function(){n.setCenter(a.data.geometry.location),n.setZoom(15),infoWindow.close(),infoWindow.setContent(o(a.data)),infoWindow.open(n,a.marker)},a.clickMarkerDetail=function(){e(a.marker),a.showDetail()},google.maps.event.addListener(a.marker,"click",a.clickMarkerDetail),a.clear=function(){a.marker.setMap(null)}}function n(e,o,n){service.textSearch(e,function(e,a){a==google.maps.places.PlacesServiceStatus.OK?(places=e.map(function(e,o){return new t(e,n)}),o.searchItems(places)):o.searchItems([])})}function a(){var e=this;e.showMenu=ko.observable(!0),e.showChooseType=ko.observable(!1),e.typeItems=ko.observableArray(["store","bar","bank","hospital","atm"]),e.searchWord=ko.observable(""),e.searchItems=ko.observableArray([]),e.type=ko.observable("store"),e.mainplace=ko.observable("San Francisco"),e.toggleMenu=function(){e.showMenu(!this.showMenu())},e.chooseType=function(o){e.type(o)},e.toggleChooseType=function(){e.showChooseType(!this.showChooseType())},ko.computed(function(){e.searchItems([]),places.forEach(function(e){e.clear()}),map.setCenter(centerPoint),map.setZoom(13),""===e.searchWord()?(request.types=[e.type()],n(request,e,map)):(request.types=[e.type()],request.query=e.searchWord()+"|"+e.mainplace(),n(request,e,map))})}map=new google.maps.Map(document.getElementById("map"),{center:centerPoint,zoom:13,zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!0,rotateControl:!0,fullscreenControl:!1}),infoWindow=new google.maps.InfoWindow,service=new google.maps.places.PlacesService(map),request={location:map.getCenter(),radius:"1000",types:[]},ko.applyBindings(new a)}var map,centerPoint={lat:37.7749088,lng:-122.4894555},places=[],infoWindow,service,request,isSearching=!1;